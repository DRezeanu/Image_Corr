function sensitivity = spec(peak, opticald, age)

if nargin < 2
    opticald=0.3;
    age=0;
end

%Wavelengths
WL = (400:5:700);

%Extinction Contstants

EQ_Peak=(log10(1/peak)-log10(1/558.5));

EQ_Const=[0.417050601 0.002072146 0.000163888 -1.922880605...
    -16.05774461 0.001575426 5.11376E-05 0.00157981...
    6.58428E-05	6.68402E-05	0.002310442 7.31313E-05...
    1.86269E-05	0.002008124	5.40717E-05	5.14736E-06...
    0.001455413	4.21764E-05	4.80E-06 0.001809022...
    3.86677E-05	2.99E-05 0.001757315 1.47344E-05 1.51E-05...
    EQ_Peak];

%Lens and Macular Pigment Absorptions

Stock_MP = [0.0868 0.112 0.1365 0.1631 0.1981 0.2345...
    0.2618 0.2772 0.2884 0.308 0.3332 0.3486 0.35 0.3269 0.2996 0.2842...
    0.2786 0.2772 0.2688 0.2485 0.2093 0.1652 0.1211 0.0812 0.0525...
    0.0329 0.0175 0.00929 0.00459 0.00166...
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

Stock_Lens = [1.7649, 1.4257, 1.13738, 0.9063, 0.72398, 0.59572, 0.4876,...
    0.4081, 0.34132, 0.29998, 0.26288, 0.2438, 0.2279, 0.21306, 0.20458,...
    0.19292, 0.18338, 0.1749, 0.16748, 0.16006, 0.1537, 0.14628, 0.1378,...
    0.12932, 0.12296, 0.1166, 0.11024, 0.10494, 0.09858, 0.09222, 0.08586,...
    0.0795, 0.0742, 0.06784, 0.06148, 0.05512, 0.04876, 0.04346, 0.03812,...
    0.03286, 0.02968, 0.02544, 0.02226, 0.01908, 0.01696, 0.01484, 0.01166,...
    0.00848, 0.0053, 0.00424, 0.00318, 0.00106, 0, 0, 0, 0, 0, 0, 0, 0, 0];

if age > 0
    Lens_OD = lensage(age);
else
    Lens_OD = Stock_Lens;
end

%Calculate Extinction 

ext=zeros(1,length(WL));

for x=1:length(WL)
    ext(x)=log10(-EQ_Const(5)+EQ_Const(5)*tanh(-(((10^(log10(1/WL(x))...
        -EQ_Const(26))))-EQ_Const(6))/EQ_Const(7)))+EQ_Const(4)...
        +EQ_Const(1)*tanh(-(((10^(log10(1/WL(x))-EQ_Const(26))))...
        -EQ_Const(2))/EQ_Const(3))-(EQ_Const(10)/EQ_Const(9)...
        *((1/(sqrt(2*pi)))*exp(1)^(-0.5*(((10^(log10(1/WL(x))...
        -EQ_Const(26)))-EQ_Const(8))/EQ_Const(9))^2)))...
        -(EQ_Const(13)/EQ_Const(12)*((1/(sqrt(2*pi)))...
        *exp(1)^(-0.5*(((10^(log10(1/WL(x))-EQ_Const(26)))...
        -EQ_Const(11))/EQ_Const(12))^2)))-(EQ_Const(16)/EQ_Const(15)...
        *((1/(sqrt(2*pi)))*exp(1)^(-0.5*(((10^(log10(1/WL(x))...
        -EQ_Const(26)))-EQ_Const(14))/EQ_Const(15))^2)))+(EQ_Const(19)...
        /EQ_Const(18)*((1/(sqrt(2*pi)))*exp(1)^(-0.5*(((10^(log10(1/WL(x))...
        -EQ_Const(26)))-EQ_Const(17))/EQ_Const(18))^2)))...
        +((EQ_Const(22)/EQ_Const(21)*((1/(sqrt(2*pi)))*exp(1)^(-0.5...
        *(((10^(log10(1/WL(x))-EQ_Const(26)))-EQ_Const(20))/EQ_Const(21))...
        ^2)))/10)+((EQ_Const(25)/EQ_Const(24)*((1/(sqrt(2*pi)))...
        *exp(1)^(-0.5*(((10^(log10(1/WL(x))-EQ_Const(26)))...
        -EQ_Const(23))/EQ_Const(24))^2)))/100);
end

%Calculate Extinction + Optical Density

ext_od=zeros(1,length(WL));

for x=1:length(WL)
    ext_od(x)=log10((1-10^-((10^ext(x))*opticald))/(1-10^-...
        opticald))-Lens_OD(x)-Stock_MP(x);
end

%Calculate Spectral Sensitivity

sensitivity=zeros(1,length(WL));

for x=1:length(WL)
    sensitivity(x)=10^(ext_od(x));
end
end